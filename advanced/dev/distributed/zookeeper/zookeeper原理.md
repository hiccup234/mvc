
## ZooKeeper原理

    ZooKeeper（Zab协议：Paoxs算法）：分布式锁服务、配置维护、组服务、分布式消息队列、分布式通知/协调等
    
    
### Paoxs算法核心原理

    选举过程中少数服从多数，最终达成一致意见，所以节点总数一定要是单数。
    
    前置假设：
        消息内容不会被篡改，即无拜占庭将军问题。
    
    算法分两个阶段：
        1、prepare（贿选）：多个提议者（Proposer）提出意见，需要明确一个意见领袖，明确后其他接受者（Acceptor）就主要处理这个意见领袖的提议（尽早让意见同一，尽早形成多数派）
            一般通过编号来明确意见领袖，每个提议者都报一个数（proposal_id），谁报的数大就选谁为意见领袖。
            
            如果某个提议者向某个接受者提出意见时，这个接受者已经接受过前面的意见领袖的提议（Proposal）了（尽管可能自己的编号比前面的意见领袖大），
            那么就放弃自己的提议意见，改为前面意见领袖的意见。
        2、提出提议：由1中的意见领袖提出提议，如果被多数接受者接受了，那么这个提议就通过了。
    
    数学原理：
        我们称大多数进程组成的集合为法定集合，两个法定集合必然存在非空交集，即至少有一个公共进程，称为法定集合性质。 
        例如A,B,C,D,F进程组成的全集，法定集合Q1包括进程A,B,C，Q2包括进程B,C,D，那么Q1和Q2的交集必然不在空，C就是Q1，Q2的公共进程。
    
    Paxos的角色有coordinator，learner，acceptor，proposer
    一般流程是由P发送请求给C，由C告知A开始决策，决策结束后，由A通知L决策结果，在实际实现中P和C常常合一。
    
### Raft算法核心原理

    自己选举自己，每个节点有一个来自Master心跳的超时时间，150ms~300ms，如果出现脑裂选举失败，则等到超时时间到还没完成选举，则其他再发起选举。